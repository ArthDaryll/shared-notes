<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SharedNotes</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="top-bar">
    <h1>SharedNotes</h1>
    </div>

    <form onsubmit="event.preventDefault(); addNote();">
        <input type="text" id="note-content" placeholder="Write a note..." required>
        <button type="submit">Add Note</button>
    </form>

    <hr>

    <div class="notes-list">
        <h2>Saved Notes:</h2>
        <ul id="notes-container">
            {% for note in notes %}
                <li id="note-{{ note.id }}" style="margin-bottom: 10px;">
                    {{ note.content }}
                    <button onclick="deleteNote({{ note.id }})" style="color: red; margin-left: 10px; cursor: pointer;">
                        Delete
                    </button>
                </li>
            {% endfor %}
        </ul>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>

    <script>
    var socket = io();

    function addNote() {
        const input = document.getElementById('note-content');
        const content = input.value;
        if (content) {
            socket.emit('add_note', {content: content});
            input.value = ''; // Clears the box after sending
        }
    }

    function deleteNote(id) {
        socket.emit('delete_note', {id: id});
    }

    // Receiving updates (Real-time sync)
    socket.on('note_added', function(data) {
        const ul = document.getElementById('notes-container');
        // We add the new item with the same style and delete button
        ul.innerHTML += `
            <li id="note-${data.id}" style="margin-bottom: 10px;">
                ${data.content} 
                <button onclick="deleteNote(${data.id})" style="color: red; margin-left: 10px; cursor: pointer;">
                    Delete
                </button>
            </li>`;
    });

    socket.on('note_deleted', function(data) {
        const element = document.getElementById(`note-${data.id}`);
        if (element) {
            element.remove();
        }
    });
</script>

</body>
</html>